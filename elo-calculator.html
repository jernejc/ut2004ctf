<html>
<div id="data"></div>
<script>
    var buff = '';
    var players = [];

    players['Gooz'] = 2030;
	players['Koffee'] = 2020;
	players['MVDE'] = 2020;
	players['mnt'] = 2000;
    players['simson'] = 1950;
    players['TT-Tolyan'] = 1940;
    players['ImitatoR'] = 1900;
    players['Maldito'] = 1850;
	players['j'] = 1840;
    players['chitrox'] = 1850;
    players['Hodor'] = 1830;
    players['pr!x'] = 1830;
	players['Small'] = 1800;
    players['pepper'] = 1800;
    players['Sonic'] = 1800;
    players['Alter'] = 1800;
    players['Cold-M'] = 1800;
    players['Rigel'] = 1750;
    players['Loox'] = 1750;
    players['what'] = 1750;
    players['MoRoZ'] = 1750;
    players['Forsiets'] = 1700;
    players['WG'] = 1600;
	players['Krnki'] = 1600;
    players['Thoums'] = 1500;
    players['Bad_Bond'] = 1500;

    var games = [];

    // 02.05
    games.push({
        'red': ['MVDE', 'Alter', 'TT-Tolyan', 'Maldito', 'chitrox'],
        'blue': ['ImitatoR', 'Gooz', 'pr!x', 'Cold-M', 'Loox'],
        'redScore': 1,
        'blueScore': 6
    });

    games.push({
        'red': ['MVDE', 'Alter', 'TT-Tolyan', 'Maldito', 'chitrox'],
        'blue': ['ImitatoR', 'Gooz', 'pr!x', 'Cold-M', 'Loox'],
        'redScore': 2,
        'blueScore': 1
    });

    games.push({
        'red': ['MVDE', 'ImitatoR', 'TT-Tolyan', 'Maldito', 'chitrox'],
        'blue': ['mnt', 'Gooz', 'pr!x', 'Cold-M', 'Loox'],
        'redScore': 7,
        'blueScore': 2
    });

    games.push({
        'red': ['MVDE', 'ImitatoR', 'TT-Tolyan', 'Maldito', 'chitrox'],
        'blue': ['mnt', 'Gooz', 'pr!x', 'Cold-M', 'Loox'],
        'redScore': 1,
        'blueScore': 0
    });

    games.push({
        'red': ['MVDE', 'ImitatoR', 'TT-Tolyan', 'Maldito', 'chitrox'],
        'blue': ['mnt', 'Gooz', 'pr!x', 'Cold-M', 'Loox'],
        'redScore': 4,
        'blueScore': 0
    });

    // 07.05
    games.push({
        'red': ['mnt', 'Gooz', 'TT-Tolyan', 'Cold-M', 'pr!x'],
        'blue': ['MVDE', 'ImitatoR', 'Koffee', 'WG', 'chitrox'],
        'redScore': 2,
        'blueScore': 3
    });

    games.push({
        'red': ['mnt', 'Gooz', 'TT-Tolyan', 'Cold-M', 'pr!x'],
        'blue': ['MVDE', 'ImitatoR', 'Koffee', 'WG', 'chitrox'],
        'redScore': 6,
        'blueScore': 4
    });

    games.push({
        'red': ['mnt', 'Gooz', 'TT-Tolyan', 'Cold-M', 'pr!x'],
        'blue': ['MVDE', 'ImitatoR', 'Koffee', 'WG', 'chitrox'],
        'redScore': 1,
        'blueScore': 9
    });

    games.push({
        'red': ['mnt', 'Gooz', 'TT-Tolyan', 'Cold-M', 'pr!x'],
        'blue': ['MVDE', 'ImitatoR', 'Koffee', 'WG', 'chitrox'],
        'redScore': 7,
        'blueScore': 4
    });

    games.push({
        'red': ['mnt', 'Gooz', 'TT-Tolyan', 'Cold-M', 'pr!x'],
        'blue': ['MVDE', 'ImitatoR', 'Koffee', 'WG', 'chitrox'],
        'redScore': 3,
        'blueScore': 4
    });

    // 09.05
    games.push({
        'red': ['mnt', 'Rigel', 'chitrox', 'ImitatoR', 'Cold-M'],
        'blue': ['Gooz', 'TT-Tolyan', 'MoRoZ', 'WG', 'Maldito'],
        'redScore': 7,
        'blueScore': 2
    });

    games.push({
        'red': ['mnt', 'Rigel', 'chitrox', 'ImitatoR', 'Cold-M'],
        'blue': ['MVDE', 'TT-Tolyan', 'MoRoZ', 'WG', 'Maldito'],
        'redScore': 4,
        'blueScore': 3
    });

    games.push({
        'red': ['mnt', 'Rigel', 'chitrox', 'ImitatoR', 'Cold-M'],
        'blue': ['MVDE', 'TT-Tolyan', 'MoRoZ', 'WG', 'Maldito'],
        'redScore': 4,
        'blueScore': 5
    });

    games.push({
        'red': ['mnt', 'Rigel', 'chitrox', 'ImitatoR', 'Cold-M'],
        'blue': ['MVDE', 'TT-Tolyan', 'MoRoZ', 'WG', 'Maldito'],
        'redScore': 4,
        'blueScore': 3
    });

    games.push({
        'red': ['mnt', 'Rigel', 'chitrox', 'ImitatoR', 'MoRoZ'],
        'blue': ['MVDE', 'TT-Tolyan', 'Cold-M', 'WG', 'Maldito'],
        'redScore': 3,
        'blueScore': 4
    });

    // 10.05
    games.push({
        'red': ['mnt', 'Rigel', 'chitrox', 'ImitatoR', 'MoRoZ'],
        'blue': ['MVDE', 'TT-Tolyan', 'Cold-M', 'WG', 'Maldito'],
        'redScore': 1,
        'blueScore': 0
    });

    //11.05
    games.push({
        'red': ['Koffee', 'pepper', 'Cold-M', 'mnt', 'Maldito'],
        'blue': ['pr!x', 'TT-Tolyan', 'ImitatoR', 'MVDE', 'chitrox'],
        'redScore': 5,
        'blueScore': 7
    });

    games.push({
        'red': ['Koffee', 'pepper', 'Cold-M', 'mnt', 'Maldito'],
        'blue': ['pr!x', 'TT-Tolyan', 'ImitatoR', 'MVDE', 'chitrox'],
        'redScore': 2,
        'blueScore': 9
    });

    games.push({
        'red': ['Koffee', 'pepper', 'Cold-M', 'mnt', 'Maldito'],
        'blue': ['pr!x', 'TT-Tolyan', 'ImitatoR', 'MVDE', 'chitrox'],
        'redScore': 2,
        'blueScore': 5
    });

    games.push({
        'red': ['Koffee', 'pepper', 'Cold-M', 'mnt', 'Maldito'],
        'blue': ['pr!x', 'TT-Tolyan', 'ImitatoR', 'MVDE', 'chitrox'],
        'redScore': 3,
        'blueScore': 4
    });

    //14.05
    games.push({
        'red': ['mnt', 'MVDE', 'WG', 'Cold-M', 'chitrox'],
        'blue': ['pr!x', 'TT-Tolyan', 'ImitatoR', 'Koffee', 'simson'],
        'redScore': 5,
        'blueScore': 1
    });

    games.push({
        'red': ['mnt', 'MVDE', 'WG', 'Cold-M', 'chitrox'],
        'blue': ['pr!x', 'TT-Tolyan', 'ImitatoR', 'Sonic', 'simson'],
        'redScore': 5,
        'blueScore': 2
    });

    //16.05
    games.push({
        'red': ['pr!x', 'Hodor', 'Gooz', 'WG', 'ImitatoR'],
        'blue': ['MVDE', 'TT-Tolyan', 'Cold-M', 'Maldito', 'chitrox'],
        'redScore': 4,
        'blueScore': 5
    });

    games.push({
        'red': ['pr!x', 'Hodor', 'Gooz', 'WG', 'ImitatoR'],
        'blue': ['MVDE', 'TT-Tolyan', 'Cold-M', 'Maldito', 'chitrox'],
        'redScore': 5,
        'blueScore': 4
    });

    games.push({
        'red': ['pr!x', 'Hodor', 'Gooz', 'WG', 'ImitatoR'],
        'blue': ['MVDE', 'TT-Tolyan', 'Cold-M', 'Maldito', 'chitrox'],
        'redScore': 3,
        'blueScore': 4
    });

    //19.05
    games.push({
        'red': ['TT-Tolyan', 'ImitatoR', 'Cold-M', 'pr!x', 'Loox'],
        'blue': ['MVDE', 'chitrox', 'Forsiets', 'Koffee', 'WG'],
        'redScore': 4,
        'blueScore': 3
    });

    games.push({
        'red': ['TT-Tolyan', 'ImitatoR', 'Cold-M', 'pr!x', 'Loox'],
        'blue': ['MVDE', 'chitrox', 'Forsiets', 'Koffee', 'WG'],
        'redScore': 5,
        'blueScore': 4
    });

    games.push({
        'red': ['TT-Tolyan', 'ImitatoR', 'Cold-M', 'pr!x', 'Loox'],
        'blue': ['MVDE', 'chitrox', 'Forsiets', 'Koffee', 'WG'],
        'redScore': 7,
        'blueScore': 4
    });

    // 23.05
    games.push({
        'red': ['Cold-M', 'mnt', 'Gooz', 'Hodor', 'WG'],
        'blue': ['MVDE', 'chitrox', 'TT-Tolyan', 'ImitatoR', 'Maldito'],
        'redScore': 2,
        'blueScore': 7
    });

    games.push({
        'red': ['TT-Tolyan', 'mnt', 'Gooz', 'Hodor', 'WG'],
        'blue': ['MVDE', 'chitrox', 'Cold-M', 'ImitatoR', 'Maldito'],
        'redScore': 2,
        'blueScore': 4
    });

    games.push({
        'red': ['MVDE', 'mnt', 'Maldito', 'chitrox', 'Forsiets'],
        'blue': ['TT-Tolyan', 'Gooz', 'Cold-M', 'ImitatoR', 'WG'],
        'redScore': 6,
        'blueScore': 5
    });

    games.push({
        'red': ['MVDE', 'mnt', 'Maldito', 'chitrox', 'Forsiets'],
        'blue': ['TT-Tolyan', 'Gooz', 'Cold-M', 'ImitatoR', 'WG'],
        'redScore': 4,
        'blueScore': 3
    });

    // 24.05
    games.push({
        'red': ['MVDE', 'pr!x', 'Loox', 'Koffee', 'Thoums'],
        'blue': ['mnt', 'Gooz', 'Cold-M', 'Bad_Bond', 'what'],
        'redScore': 7,
        'blueScore': 0
    });

    games.push({
        'red': ['MVDE', 'pr!x', 'what', 'Koffee', 'Thoums'],
        'blue': ['mnt', 'Gooz', 'Cold-M', 'Bad_Bond', 'Loox'],
        'redScore': 6,
        'blueScore': 2
    });

    //26.05
    games.push({
        'red': ['Cold-M', 'Koffee', 'chitrox', 'Thoums', 'ImitatoR'],
        'blue': ['MVDE', 'TT-Tolyan', 'Rigel', 'simson', 'Loox'],
        'redScore': 2,
        'blueScore': 6
    });

    games.push({
        'red': ['Cold-M', 'Koffee', 'chitrox', 'Loox', 'ImitatoR'],
        'blue': ['MVDE', 'TT-Tolyan', 'Rigel', 'simson', 'Thoums'],
        'redScore': 1,
        'blueScore': 4
    });

    games.push({
        'red': ['Gooz', 'Koffee', 'Rigel', 'Loox', 'Thoums'],
        'blue': ['MVDE', 'TT-Tolyan', 'ImitatoR', 'chitrox', 'Cold-M'],
        'redScore': 5,
        'blueScore': 7
    });

    games.push({
        'red': ['Gooz', 'Koffee', 'Rigel', 'Loox', 'Thoums'],
        'blue': ['MVDE', 'TT-Tolyan', 'ImitatoR', 'chitrox', 'Cold-M'],
        'redScore': 5,
        'blueScore': 6
    });

	// 28.05
	games.push({
        'red': ['MVDE', 'Cold-M', 'Thoums', 'chitrox', 'ImitatoR'],
        'blue': ['Gooz', 'Loox', 'pr!x', 'Koffee', 'Krnki'],
        'redScore': 0,
        'blueScore': 7
    });
	
	games.push({
        'red': ['MVDE', 'pr!x', 'Thoums', 'chitrox', 'ImitatoR'],
        'blue': ['Gooz', 'Loox', 'Cold-M', 'Koffee', 'Krnki'],
        'redScore': 1,
        'blueScore': 2
    });
	
	games.push({
        'red': ['MVDE', 'pr!x', 'Thoums', 'chitrox', 'ImitatoR'],
        'blue': ['Gooz', 'Loox', 'Cold-M', 'Koffee', 'Krnki'],
        'redScore': 0,
        'blueScore': 7
    });
	
	games.push({
        'red': ['MVDE', 'Gooz', 'Thoums', 'chitrox', 'Rigel'],
        'blue': ['TT-Tolyan', 'ImitatoR', 'Cold-M', 'Koffee', 'Krnki'],
        'redScore': 3,
        'blueScore': 4
    });
	
	games.push({
        'red': ['MVDE', 'TT-Tolyan', 'ImitatoR', 'chitrox', 'Cold-M'],
        'blue': ['Gooz', 'Small', 'Thoums', 'Koffee', 'Rigel'],
        'redScore': 5,
        'blueScore': 0
    });
	
	// 30.05
	games.push({
        'red': ['MVDE', 'ImitatoR', 'chitrox', 'MoRoZ', 'WG'],
        'blue': ['Gooz', 'TT-Tolyan', 'Cold-M', 'Maldito', 'Forsiets'],
        'redScore': 6,
        'blueScore': 4
    });
	
	games.push({
        'red': ['MVDE', 'ImitatoR', 'chitrox', 'MoRoZ', 'WG'],
        'blue': ['Gooz', 'TT-Tolyan', 'Cold-M', 'Maldito', 'Forsiets'],
        'redScore': 3,
        'blueScore': 4
    });
	
	games.push({
        'red': ['MVDE', 'ImitatoR', 'chitrox', 'MoRoZ', 'WG'],
        'blue': ['Gooz', 'TT-Tolyan', 'Cold-M', 'Maldito', 'Forsiets'],
        'redScore': 0,
        'blueScore': 3
    });
	
	games.push({
        'red': ['MVDE', 'ImitatoR', 'chitrox', 'MoRoZ', 'WG'],
        'blue': ['Gooz', 'TT-Tolyan', 'Cold-M', 'Maldito', 'Forsiets'],
        'redScore': 2,
        'blueScore': 3
    });
	
	// 02.06
	games.push({
        'red': ['MVDE', 'ImitatoR', 'chitrox', 'MoRoZ', 'WG'],
        'blue': ['Gooz', 'TT-Tolyan', 'Cold-M', 'Maldito', 'Forsiets'],
        'redScore': 2,
        'blueScore': 3
    });
	
	games.push({
        'red': ['MVDE', 'pr!x', 'Cold-M', 'Thoums', 'j'],
        'blue': ['Gooz', 'mnt', 'ImitatoR', 'chitrox', 'Rigel'],
        'redScore': 1,
        'blueScore': 4
    });
	
	games.push({
        'red': ['MVDE', 'pr!x', 'Cold-M', 'Thoums', 'j'],
        'blue': ['Gooz', 'mnt', 'ImitatoR', 'chitrox', 'Rigel'],
        'redScore': 0,
        'blueScore': 7
    });
	
	games.push({
        'red': ['MVDE', 'pr!x', 'Cold-M', 'Rigel', 'j'],
        'blue': ['Gooz', 'mnt', 'ImitatoR', 'chitrox', 'Thoums'],
        'redScore': 4,
        'blueScore': 5
    });
	
	// 04.06
	games.push({
        'red': ['mnt', 'Gooz', 'pr!x', 'Cold-M', 'Thoums'],
        'blue': ['TT-Tolyan', 'Koffee', 'ImitatoR', 'chitrox', 'Rigel'],
        'redScore': 5,
        'blueScore': 6
    });
	
	games.push({
        'red': ['mnt', 'Gooz', 'pr!x', 'Cold-M', 'Thoums'],
        'blue': ['TT-Tolyan', 'Koffee', 'ImitatoR', 'chitrox', 'Rigel'],
        'redScore': 3,
        'blueScore': 9
    });
	
	games.push({
        'red': ['mnt', 'Gooz', 'pr!x', 'Cold-M', 'Thoums'],
        'blue': ['TT-Tolyan', 'Koffee', 'ImitatoR', 'chitrox', 'Rigel'],
        'redScore': 2,
        'blueScore': 3
    });
	
	games.push({
        'red': ['mnt', 'Gooz', 'pr!x', 'Cold-M', 'Thoums'],
        'blue': ['TT-Tolyan', 'Koffee', 'ImitatoR', 'chitrox', 'Rigel'],
        'redScore': 2,
        'blueScore': 1
    });
	
	// 05.06
	games.push({
        'red': ['MVDE', 'Gooz', 'chitrox', 'Maldito', 'Thoums'],
        'blue': ['TT-Tolyan', 'Koffee', 'ImitatoR', 'Cold-M', 'Loox'],
        'redScore': 3,
        'blueScore': 1
    });
	
	games.push({
        'red': ['ImitatoR', 'Gooz', 'chitrox', 'Hodor', 'Thoums'],
        'blue': ['TT-Tolyan', 'MVDE', 'Maldito', 'Cold-M', 'Loox'],
        'redScore': 2,
        'blueScore': 4
    });
	
    //buff += "Games:\n";
    //console.log('Games:');

    for (i in games) {
        txt = games[i].red.join(' ') + ' [' + games[i].redScore + ':' + games[i].blueScore + '] ' + games[i].blue.join(' ');
        //buff += txt + "\n";
        //console.log(txt);
    }

    var calculateTeamTotalElo = function(team) {

        var sum = 0;

        for (var k in team) {
            sum += players[team[k]];
        }

        return sum;
    };

    var isRedTeamPlayer = function(game, playerName) {

        for (var k in game.red) {
            if (game.red[k] === playerName) {
                return true;
            }
        }

        return false;
    };

    var getPlayerEloInGame = function(playerName, game) {

        var oldElo = players[playerName],
            myTeamScore,
            opTeamScore,
            myTeamElo,
            opTeamElo,
            Sa,
			isWin;

        if (typeof players[playerName] === "undefined") {
            console.log('Unknow player ' + playerName);
        }

        if (isRedTeamPlayer(game, playerName)) {
            myTeamScore = game.redScore;
            opTeamScore = game.blueScore;
            myTeamElo = calculateTeamTotalElo(game.red);
            opTeamElo = calculateTeamTotalElo(game.blue);
        } else {
            myTeamScore = game.blueScore;
            opTeamScore = game.redScore;
            myTeamElo = calculateTeamTotalElo(game.blue);
            opTeamElo = calculateTeamTotalElo(game.red);
        }

        Sa = 0;
		K = oldElo / 400;
		isWin = myTeamScore > opTeamScore;

        if (opTeamElo >= myTeamElo && isWin) {
			Sa += 2 * K;
		} else if (myTeamElo > opTeamElo && isWin) {
			Sa += K;
		} else if (opTeamElo >= myTeamElo && !isWin) {
			Sa -= K;
		} else {
			Sa -= 2 * K;
		}

        return oldElo + Sa;
    };

    var updateTeamsEloInGame = function(game) {

        var playersInGame = game.red.concat(game.blue),
            eloResults = [];

        for (var i in playersInGame) {
            eloResults[playersInGame[i]] = getPlayerEloInGame(playersInGame[i], game);
        }

        for (var playerName in eloResults) {
            players[playerName] = eloResults[playerName];
        }
    };

    for (i in games) {
        updateTeamsEloInGame(games[i]);
    }

    function getSortedKeys(obj) {
        var keys = keys = Object.keys(obj);
        return keys.sort(function(a, b) {
            return obj[b] - obj[a]
        });
    }

    var sortedPlayers = getSortedKeys(players);

    var winRates = [];

    for (i in players) {

        winRates[i] = {
            wins: 0,
            loses: 0,
            avg: 0
        };
    }

    var updatePlayerWinRateInGame = function(playerName, game) {

        if (isRedTeamPlayer(game, playerName)) {
            if (game.redScore > game.blueScore) {
                ++winRates[playerName].wins;
            } else {
                ++winRates[playerName].loses;
            }
        } else {
            if (game.blueScore > game.redScore) {
                ++winRates[playerName].wins;
            } else {
                ++winRates[playerName].loses;
            }
        }
    };

    var updateTeamsWinRateInGame = function(game) {

        var playersInGame = game.red.concat(game.blue);

        for (var i in playersInGame) {
            updatePlayerWinRateInGame(
                playersInGame[i],
                game
            );
        }
    };

    for (i in games) {
        updateTeamsWinRateInGame(games[i]);
    }

    for (i in winRates) {
        winRates[i].avg = Math.ceil((winRates[i].wins / (winRates[i].wins + winRates[i].loses)) * 100);
    }

	var data = document.getElementById('data');

	buff = '<table style="border: #ccc solid 1px; border-collapse: collapse;">'
	+ '<tbody><tr>'
	+ '<th style="border: #ccc solid 1px; padding: 5px 10px;">Rank</th>'
	+ '<th style="border: #ccc solid 1px; padding: 5px 10px;">Name</th>'
	+ '<th style="border: #ccc solid 1px; padding: 5px 10px;">Elo-Rating</th>'
	+ '<th style="border: #ccc solid 1px; padding: 5px 10px;">Wins</th>'
	+ '<th style="border: #ccc solid 1px; padding: 5px 10px;">Loses</th>'
	+ '<th style="border: #ccc solid 1px; padding: 5px 10px;">Wins %</th>'
	+ '</tr></tbody>';
	
    for (i in sortedPlayers) {
		buff += '<tr>';
		buff += '<td style="border: #ccc solid 1px; padding: 5px 10px; text-align: right;">' + (parseInt(i, 10) + 1) + '</td>';
		buff += '<td style="border: #ccc solid 1px; padding: 5px 10px;">' + sortedPlayers[i] + '</td>';
		buff += '<td style="border: #ccc solid 1px; padding: 5px 10px;">' + Math.ceil(players[sortedPlayers[i]]) + '</td>';
		buff += '<td style="border: #ccc solid 1px; padding: 5px 10px;">' + winRates[sortedPlayers[i]].wins + '</td>';
		buff += '<td style="border: #ccc solid 1px; padding: 5px 10px;">' + winRates[sortedPlayers[i]].loses + '</td>';
		buff += '<td style="border: #ccc solid 1px; padding: 5px 10px;">' + winRates[sortedPlayers[i]].avg + '</td>';
		buff += '</tr>';
    }
	
	buff += '</table>';
	
	buff += '<br /><br /><h4>Elo-rank calculation rules:</h4>';
	buff += 'New Elo-rating = Old Elo-rating + Pts * (Old Elo-rating / 400)<br /><br />';
	buff += 'Pts = +2 points for winning against a team with the lower Elo-rating than your team.<br />';
	buff += 'Pts = +1 points for winning against a team with the same or greater Elo-rating than your team.<br />';
	buff += 'Pts = -1 points for losing against a team with the same or greater Elo-rating than your team.<br />';
	buff += 'Pts = -2 points for losing against a team with the lower Elo-rating than your team.<br /><br />';
	buff += '<br /><br /><br />';
	
	data.innerHTML = buff;

</script>
</html>